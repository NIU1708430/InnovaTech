# Caso de Uso: Distribuir Pago

### Versión
1.0

### Fecha
05/05/2025

### Autores
Elías Pascual Paz

---

### Descripción
Este caso de uso describe cómo, una vez confirmada una transacción, el sistema distribuye automáticamente el importe del pago entre el cocinero y el repartidor, según las tarifas establecidas y utilizando sus cuentas bancarias asociadas.

---

### Actores
- Cocinero  
- Repartidor  
- Plataforma de Pago (proveedor externo)

---

### Precondiciones
- El cliente ha realizado el pago de un pedido.
- El sistema ha recibido confirmación de una transacción exitosa desde la plataforma de pago.
- Cocinero y repartidor tienen cuentas bancarias registradas en el sistema.

---

### Flujo Principal
1. El sistema identifica el cocinero y el repartidor asignados al pedido.
2. Recupera las tarifas correspondientes.
3. Calcula el importe correspondiente a cada uno.
4. Se conecta con la plataforma de pago para realizar las transferencias a las cuentas bancarias asociadas.
5. Registra el resultado de la operación y marca el pedido como "pagado y distribuido".

---

### Subflujos
- **Consulta de tarifas**: Se obtienen las tarifas vigentes desde la configuración del sistema.
- **Cálculo de montos**: Determinación de la parte proporcional de cocinero y repartidor.

---

### Flujos Alternativos
- **Error en la transferencia**:  
  Si la transferencia a una cuenta bancaria falla, se genera una alerta y se reintenta en un intervalo determinado.

- **Cuenta no registrada**:  
  Si alguno de los actores no tiene cuenta bancaria asociada, el sistema detiene la distribución y lanza una alerta administrativa.

---

### Postcondiciones
- Los ingresos se han distribuido correctamente según las tarifas configuradas.
- El pedido se registra como distribuido.

---

### Requisitos No Funcionales
- Uso de canales cifrados para todas las transacciones.
- Integridad y consistencia en el registro de las operaciones.

---

### Prioridad
Alta

---

### Comentarios
Es fundamental definir con claridad las tarifas de distribución y garantizar que los datos bancarios estén verificados antes de permitir la asignación de pedidos.
